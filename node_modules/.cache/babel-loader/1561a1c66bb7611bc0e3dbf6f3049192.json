{"ast":null,"code":"var _jsxFileName = \"/home/elouati/Bureau/projet_working/client/src/Menu/Menu.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useContext } from 'react';\nimport { Button, TextField } from '@material-ui/core';\nimport Select from '@material-ui/core/Select';\nimport FormControl from '@material-ui/core/FormControl';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport { socket } from '../socket.js';\nimport Typography from '@material-ui/core/Typography';\nimport AnimatorLoader from '../Game/animator/AnimatorLoader.js';\nimport PlayerContext from './player-context';\nimport { setPlayerClass, getSubBassin } from '../Game/map/MapUtil.js';\nimport MenuContext from './menu-context';\nimport Game from '../Game/Game.js';\nimport Updating from \"../Interface/Updating/Updating\";\nimport warningText from '../Game/controls/warningText.js';\nimport Header from \"../Interface/Header/Header\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction Menu() {\n  _s();\n\n  const playerCtx = useContext(PlayerContext);\n  console.log(playerCtx);\n  const MenuCtx = useContext(MenuContext);\n  const marg = {\n    marginRight: 5\n  };\n\n  const handleName = event => {\n    playerCtx.updateName(event.target.value);\n  };\n\n  const handleChange = event => {\n    playerCtx.updateRole(event.target.value);\n  };\n\n  const handleRoomName = event => {\n    const fRoom = event.target.value.toLowerCase();\n    playerCtx.updateRoom(fRoom);\n  };\n\n  const [loading, setLoading] = useState(false);\n  const [playerList, setPlayerList] = useState([]);\n  const [warningMessage, setWarningMessage] = useState(\"\");\n  socket.on(\"playersUpdate\", resp => {\n    setPlayerList(resp);\n  });\n  const [playerGameStarted, setPlayerGameStarted] = useState(false);\n  socket.on(\"mapReady\", () => {\n    setPlayerGameStarted(true);\n  });\n  socket.on(\"start\", () => {\n    MenuCtx.updateLocation(\"started\");\n  });\n\n  async function handleCreate() {\n    if (playerCtx.name === \"\" || playerCtx.role === \"\") {\n      setWarningMessage(\"Veuillez remplir les champs\");\n    } else {\n      console.log(playerCtx.role);\n      const room = await new Promise(resolve => {\n        socket.emit(\"createRoom\", playerCtx.name, playerCtx.role, response => {\n          resolve(response);\n        });\n      });\n      playerCtx.updateRoom(room);\n      MenuCtx.updateLocation(\"lobbyCreated\");\n    }\n  }\n\n  async function handleJoin() {\n    if (playerCtx === \"\" || playerCtx.name === \"\" || playerCtx.role === \"\") {\n      setWarningMessage(\"Veuillez remplir les champs\");\n    } else {\n      const room = await new Promise(resolve => {\n        socket.emit(\"joinRoom\", playerCtx.room, playerCtx.name, playerCtx.role, response => {\n          resolve(response);\n        });\n      });\n\n      if (room === \"Code de lobby incorrect\") {\n        setWarningMessage(room);\n      } else {\n        playerCtx.updateRoom(room);\n        MenuCtx.updateLocation(\"lobbyJoined\");\n      }\n    }\n  }\n\n  function handleStart() {\n    setLoading(true);\n    socket.emit(\"startGame\");\n  }\n\n  async function getNewPlayerList() {\n    const newLst = await new Promise(resolve => {\n      socket.emit(\"playersFromRoom\", playerCtx.room, resp => {\n        resolve(resp);\n      });\n    });\n\n    if (newLst === \"Partie inexistante\") {\n      setWarningMessage(newLst);\n    } else {\n      setPlayerList(newLst);\n    }\n  }\n\n  async function handleReconnectChange(event) {\n    const lngth = event.target.value.length;\n    const pName = event.target.value.substring(0, lngth - 1);\n    const pRole = event.target.value.substring(lngth - 1);\n    playerCtx.updateName(pName);\n    playerCtx.updateRole(pRole);\n  }\n\n  async function handleReconnect() {\n    if (playerCtx.room === \"\" || playerCtx.name === \"\") {\n      setWarningMessage(\"Veuillez remplir les champs\");\n    } else {\n      socket.emit(\"reconnect\", playerCtx.room, playerCtx.name, () => {\n        MenuCtx.updateLocation(\"started\");\n        socket.emit(\"getTurn\", response => {\n          if (response > -1) setPlayerGameStarted(true);\n        });\n      });\n    }\n  }\n\n  function CreateForm() {\n    playerCtx.updateRole(3);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(TextField, {\n        label: \"Pseudo\",\n        value: playerCtx.name,\n        onChange: handleName\n      }, \"name\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        onClick: handleCreate,\n        children: \"Cr\\xE9er\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 17\n      }, this), warningText(warningMessage), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        style: marg,\n        onClick: () => {\n          MenuCtx.updateLocation(\"menu\");\n        },\n        children: \"Menu\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 13\n    }, this);\n  }\n\n  function JoinForm() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(TextField, {\n        label: \"Code Partie\",\n        value: playerCtx.room,\n        onChange: handleRoomName\n      }, \"roomName\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(TextField, {\n        label: \"Pseudo\",\n        value: playerCtx.name,\n        onChange: handleName\n      }, \"nameJoin\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n        children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n          id: \"role-label\",\n          children: \"Role\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Select, {\n          labelId: \"role-label\",\n          id: \"role\",\n          value: playerCtx.role,\n          onChange: handleChange,\n          children: [/*#__PURE__*/_jsxDEV(MenuItem, {\n            value: 1,\n            children: \"Agriculteur\"\n          }, 1, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(MenuItem, {\n            value: 0,\n            children: \"Elu\"\n          }, 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(MenuItem, {\n            value: 2,\n            children: \"Gestionnaire de Bassin\"\n          }, 2, false, {\n            fileName: _jsxFileName,\n            lineNumber: 193,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        onClick: handleJoin,\n        children: \"Rejoindre la partie\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 17\n      }, this), warningText(warningMessage), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        style: marg,\n        onClick: () => {\n          MenuCtx.updateLocation(\"menu\");\n        },\n        children: \"Menu\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 13\n    }, this);\n  }\n\n  function roleToString(role) {\n    if (role === 1) return \"agriculteur\";\n    if (role === 3) return \"animateur\";\n    if (role === 2) return \"gestionnaire\";\n    if (role === 0) return \"elu\";\n    return \"\";\n  }\n\n  function displayNumBassin(id) {\n    if (id === 0 || id > 9) return \"\";\n    return `${getSubBassin(id)} bassin`;\n  }\n\n  function LobbyCreated() {\n    let bassin = \"\";\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h3\",\n        children: playerCtx.room\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(List, {\n        children: playerList.map(item => /*#__PURE__*/_jsxDEV(ListItem, {\n          children: /*#__PURE__*/_jsxDEV(ListItemText, {\n            primary: `${item.Name} ${roleToString(item.Role)} ${item.Id} ${displayNumBassin(item.Id)}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 29\n          }, this)\n        }, item.Id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 25\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        onClick: handleStart,\n        children: \"Commencer la partie\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 17\n      }, this), loading && /*#__PURE__*/_jsxDEV(Typography, {\n        children: \"Chargement...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 29\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 13\n    }, this);\n  }\n\n  function PlayersWaitingLobby() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(Typography, {\n        children: \"L'animateur est en train de pr\\xE9parer la carte. Veuillez patienter\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 13\n    }, this);\n  }\n\n  function LobbyJoined() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h3\",\n        children: playerCtx.room\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(List, {\n        children: playerList.map(item => /*#__PURE__*/_jsxDEV(ListItem, {\n          children: [console.log(item), /*#__PURE__*/_jsxDEV(ListItemText, {\n            primary: item.Name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 29\n          }, this)]\n        }, item.Id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 25\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 13\n    }, this);\n  }\n  /*function GameStarted() {\n      {console.log(\"Context ROLE IS : \"+playerCtx.role+\" and NAME : \" + playerCtx.name)};\n      return (\n          <div>\n              {playerCtx.role > 2 ? <AnimatorLoader name={playerCtx.name} room={playerCtx.room} /> :\n                  playerGameStarted ? <Game name={playerCtx.name} role={playerCtx.role} room={playerCtx.room} /> :\n                      <div className=\"App-header\">{PlayersWaitingLobby()}</div>}\n          </div>\n      )\n  }*/\n\n\n  function GameStarted() {\n    {\n      console.log(\"Context Player = \" + playerCtx);\n    }\n    ;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: playerCtx.role > 2 ? /*#__PURE__*/_jsxDEV(AnimatorLoader, {\n        name: playerCtx.name,\n        room: playerCtx.room\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 39\n      }, this) : playerGameStarted ? /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(Header, {\n          role: roleToString(playerCtx.role),\n          pseudo: playerCtx.name,\n          bassin: getSubBassin(playerCtx)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 45\n        }, this), /*#__PURE__*/_jsxDEV(Updating, {\n          role: roleToString(playerCtx.role),\n          ut: 23,\n          oldUt: 34,\n          ub: 2,\n          oldUb: 12,\n          formations: [1, 1, 0, 1]\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 45\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 283,\n        columnNumber: 41\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"App-header\",\n        children: PlayersWaitingLobby()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 25\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 281,\n      columnNumber: 13\n    }, this);\n  }\n\n  function RejoinGame() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: /*#__PURE__*/_jsxDEV(TextField, {\n          label: \"Code Partie\",\n          value: playerCtx.room,\n          onChange: handleRoomName\n        }, \"roomRejoin\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 296,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"contained\",\n          color: \"primary\",\n          onClick: getNewPlayerList,\n          children: \"Chercher les joueurs\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(InputLabel, {\n        id: \"nameLabel\",\n        children: \"Votre nom dans la partie\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 301,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n        children: /*#__PURE__*/_jsxDEV(Select, {\n          labelId: \"nameLabel\",\n          id: \"playerSelect\",\n          value: playerCtx.name + playerCtx.role,\n          onChange: handleReconnectChange,\n          children: playerList.map(item => /*#__PURE__*/_jsxDEV(MenuItem, {\n            value: item.Name + item.Role,\n            children: item.Name + ` (role : ` + item.Role + `)`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 311,\n            columnNumber: 29\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"contained\",\n          color: \"primary\",\n          onClick: handleReconnect,\n          children: \"Rejoindre\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 17\n      }, this), warningText(warningMessage)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 13\n    }, this);\n  }\n\n  function MainMenu() {\n    playerCtx.updateRole(\"\");\n    console.log(\"INITIAL PLAYER ROLE = \" + playerCtx);\n    console.log(\"INITIAL MENU CTX = \" + playerCtx);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        onClick: () => {\n          MenuCtx.updateLocation(\"create\");\n        },\n        children: \"Creer la partie\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 331,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        onClick: () => {\n          MenuCtx.updateLocation(\"join\");\n        },\n        children: \"Rejoindre la partie\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        onClick: () => {\n          MenuCtx.updateLocation(\"reconnect\");\n        },\n        children: \"Reconnexion a la partie en cours\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        onClick: () => {\n          window.location = \"/tutorial\";\n        },\n        children: \"Tutoriels\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 334,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 330,\n      columnNumber: 13\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: MenuCtx.loc === \"started\" ? GameStarted() : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App-header\",\n      children: [MenuCtx.loc === \"menu\" && MainMenu(), MenuCtx.loc === \"create\" && CreateForm(), MenuCtx.loc === \"join\" && JoinForm(), MenuCtx.loc === \"lobbyCreated\" && LobbyCreated(), MenuCtx.loc === \"reconnect\" && RejoinGame(), MenuCtx.loc === \"lobbyJoined\" && LobbyJoined()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 345,\n      columnNumber: 21\n    }, this)\n  }, void 0, false);\n}\n\n_s(Menu, \"4dEhGuJZvrrNa0JrSfD3SN35xhg=\");\n\n_c = Menu;\nexport default Menu;\n/* réseau zone atelier employeur\neredejeu prestataire des zone atelier\nozcar tereno strasbourg\n*/\n\nvar _c;\n\n$RefreshReg$(_c, \"Menu\");","map":{"version":3,"sources":["/home/elouati/Bureau/projet_working/client/src/Menu/Menu.js"],"names":["React","useState","useContext","Button","TextField","Select","FormControl","InputLabel","MenuItem","List","ListItem","ListItemText","socket","Typography","AnimatorLoader","PlayerContext","setPlayerClass","getSubBassin","MenuContext","Game","Updating","warningText","Header","Menu","playerCtx","console","log","MenuCtx","marg","marginRight","handleName","event","updateName","target","value","handleChange","updateRole","handleRoomName","fRoom","toLowerCase","updateRoom","loading","setLoading","playerList","setPlayerList","warningMessage","setWarningMessage","on","resp","playerGameStarted","setPlayerGameStarted","updateLocation","handleCreate","name","role","room","Promise","resolve","emit","response","handleJoin","handleStart","getNewPlayerList","newLst","handleReconnectChange","lngth","length","pName","substring","pRole","handleReconnect","CreateForm","JoinForm","roleToString","displayNumBassin","id","LobbyCreated","bassin","map","item","Name","Role","Id","PlayersWaitingLobby","LobbyJoined","GameStarted","RejoinGame","MainMenu","window","location","loc"],"mappings":"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","sourcesContent":["import React, { useState, useContext } from 'react';\nimport { Button, TextField } from '@material-ui/core';\nimport Select from '@material-ui/core/Select';\nimport FormControl from '@material-ui/core/FormControl';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\n\nimport { socket } from '../socket.js';\nimport Typography from '@material-ui/core/Typography';\nimport AnimatorLoader from '../Game/animator/AnimatorLoader.js'\nimport PlayerContext from './player-context';\nimport { setPlayerClass, getSubBassin } from '../Game/map/MapUtil.js';\nimport MenuContext from './menu-context';\n\nimport Game from '../Game/Game.js';\nimport Updating from \"../Interface/Updating/Updating\";\nimport warningText from '../Game/controls/warningText.js';\nimport Header from \"../Interface/Header/Header\";\n\n\n\nfunction Menu() {\n    const playerCtx = useContext(PlayerContext);\n    console.log(playerCtx);\n    const MenuCtx = useContext(MenuContext);\n\n\n    const marg = {\n        marginRight: 5\n    }\n\n\n\n    const handleName = (event) => {\n        playerCtx.updateName(event.target.value);\n    }\n\n    const handleChange = (event) => {\n        playerCtx.updateRole(event.target.value);\n    };\n\n    const handleRoomName = (event) => {\n        const fRoom = event.target.value.toLowerCase();\n        playerCtx.updateRoom(fRoom);\n    }\n\n    const [loading, setLoading] = useState(false)\n\n    const [playerList, setPlayerList] = useState([]);\n    const [warningMessage, setWarningMessage] = useState(\"\");\n    socket.on(\"playersUpdate\", (resp) => {\n        setPlayerList(resp);\n    });\n\n    const [playerGameStarted, setPlayerGameStarted] = useState(false);\n\n    socket.on(\"mapReady\", () => {\n        setPlayerGameStarted(true)\n    })\n    socket.on(\"start\", () => {\n        MenuCtx.updateLocation(\"started\");\n    });\n\n    async function handleCreate() {\n        if (playerCtx.name === \"\" || playerCtx.role === \"\") {\n            setWarningMessage(\"Veuillez remplir les champs\")\n        }\n        else {\n            console.log(playerCtx.role)\n\n            const room = await new Promise(resolve => {\n                socket.emit(\"createRoom\", playerCtx.name, playerCtx.role, (response) => {\n                    resolve(response);\n                });\n            });\n            playerCtx.updateRoom(room);\n            MenuCtx.updateLocation(\"lobbyCreated\");\n        }\n\n\n    }\n\n    async function handleJoin() {\n        if (playerCtx === \"\" || playerCtx.name === \"\" || playerCtx.role === \"\") {\n            setWarningMessage(\"Veuillez remplir les champs\")\n        }\n        else {\n\n\n            const room = await new Promise(resolve => {\n                socket.emit(\"joinRoom\", playerCtx.room, playerCtx.name, playerCtx.role, (response) => {\n                    resolve(response);\n                });\n            });\n            if (room === \"Code de lobby incorrect\") {\n                setWarningMessage(room);\n            }\n            else {\n                playerCtx.updateRoom(room);\n                MenuCtx.updateLocation(\"lobbyJoined\");\n            }\n        }\n    }\n\n    function handleStart() {\n        setLoading(true)\n        socket.emit(\"startGame\");\n    }\n\n    async function getNewPlayerList() {\n        const newLst = await new Promise(resolve => {\n            socket.emit(\"playersFromRoom\", playerCtx.room, (resp) => {\n                resolve(resp);\n            })\n        });\n        if (newLst === \"Partie inexistante\") {\n            setWarningMessage(newLst);\n        }\n        else {\n            setPlayerList(newLst);\n        }\n    }\n\n    async function handleReconnectChange(event) {\n        const lngth = event.target.value.length;\n        const pName = event.target.value.substring(0, lngth - 1);\n        const pRole = event.target.value.substring(lngth - 1);\n        playerCtx.updateName(pName);\n        playerCtx.updateRole(pRole);\n\n    }\n\n    async function handleReconnect() {\n        if (playerCtx.room === \"\" || playerCtx.name === \"\") {\n            setWarningMessage(\"Veuillez remplir les champs\")\n        } else {\n            socket.emit(\"reconnect\", playerCtx.room, playerCtx.name, () => {\n                MenuCtx.updateLocation(\"started\")\n                socket.emit(\"getTurn\", (response) => {\n                    if (response > -1) setPlayerGameStarted(true)\n\n                })\n            });\n        }\n    }\n\n\n\n    function CreateForm() {\n        playerCtx.updateRole(3)\n        return (\n            <div>\n                <TextField key=\"name\" label=\"Pseudo\" value={playerCtx.name} onChange={handleName}></TextField>\n                {/*                 <FormControl>\n                    <InputLabel id=\"role-label\">Role</InputLabel>\n                    <Select\n                        labelId=\"role-label\"\n                        id=\"role\"\n                        value={playerCtx.role}\n                        onChange={handleChange}\n                    >\n                        <MenuItem value={1}>Agriculteur</MenuItem>\n                        <MenuItem value={2}>Elu</MenuItem>\n                        <MenuItem value={3}>Animateur</MenuItem>\n                    </Select>\n                </FormControl> */}\n                <Button variant=\"contained\" color=\"primary\" onClick={handleCreate}>Créer</Button>\n                {warningText(warningMessage)}\n                <Button variant=\"contained\" color=\"primary\" style={marg} onClick={() => { MenuCtx.updateLocation(\"menu\") }}>Menu</Button>\n\n            </div>\n        )\n    }\n\n    function JoinForm() {\n        return (\n            <div>\n                <TextField key=\"roomName\" label=\"Code Partie\" value={playerCtx.room} onChange={handleRoomName}></TextField>\n                <TextField key=\"nameJoin\" label=\"Pseudo\" value={playerCtx.name} onChange={handleName}/>\n                <FormControl>\n                    <InputLabel id=\"role-label\">Role</InputLabel>\n                    <Select\n                        labelId=\"role-label\"\n                        id=\"role\"\n                        value={playerCtx.role}\n                        onChange={handleChange}\n                    >\n                        <MenuItem key={1} value={1}>Agriculteur</MenuItem>\n                        <MenuItem key={0} value={0}>Elu</MenuItem>\n                        <MenuItem key={2} value={2}>Gestionnaire de Bassin</MenuItem>\n                    </Select>\n                </FormControl>\n                <Button variant=\"contained\" color=\"primary\" onClick={handleJoin}>Rejoindre la partie</Button>\n                {warningText(warningMessage)}\n\n                <Button variant=\"contained\" color=\"primary\" style={marg} onClick={() => { MenuCtx.updateLocation(\"menu\") }}>Menu</Button>\n\n            </div>\n        )\n    }\n\n    function roleToString(role) {\n        if (role === 1) return \"agriculteur\"\n        if (role === 3) return \"animateur\"\n        if (role === 2) return \"gestionnaire\"\n        if (role === 0) return \"elu\"\n        return \"\"\n    }\n    function displayNumBassin(id) {\n        if (id === 0 || id > 9) return \"\"\n        return `${getSubBassin(id)} bassin`\n    }\n    function LobbyCreated() {\n        let bassin = \"\"\n        return (\n            <div>\n                <Typography variant=\"h3\">\n                    {playerCtx.room}\n                </Typography>\n                <List>\n                    {playerList.map(item => (\n                        <ListItem\n                            key={item.Id}\n                        >\n                            <ListItemText primary={`${item.Name} ${roleToString(item.Role)} ${item.Id} ${displayNumBassin(item.Id)}`} />\n                        </ListItem>\n                    ))}\n                </List>\n                <Button variant=\"contained\" color=\"primary\" onClick={handleStart} >Commencer la partie</Button>\n                {loading && <Typography>Chargement...</Typography>}\n            </div>\n        );\n    }\n    function PlayersWaitingLobby() {\n        return (\n            <div>\n                <Typography>\n                    L'animateur est en train de préparer la carte. Veuillez patienter\n                </Typography>\n            </div>\n        )\n    }\n    function LobbyJoined() {\n        return (\n            <div>\n                <Typography variant=\"h3\">\n                    {playerCtx.room}\n                </Typography>\n                <List>\n                    {playerList.map(item => (\n                        <ListItem\n                            key={item.Id}\n                        >\n                            {console.log(item)}\n                            <ListItemText primary={item.Name} />\n                        </ListItem>\n                    ))}\n                </List>\n            </div>\n        );\n    }\n\n    /*function GameStarted() {\n        {console.log(\"Context ROLE IS : \"+playerCtx.role+\" and NAME : \" + playerCtx.name)};\n        return (\n            <div>\n                {playerCtx.role > 2 ? <AnimatorLoader name={playerCtx.name} room={playerCtx.room} /> :\n                    playerGameStarted ? <Game name={playerCtx.name} role={playerCtx.role} room={playerCtx.room} /> :\n                        <div className=\"App-header\">{PlayersWaitingLobby()}</div>}\n            </div>\n        )\n    }*/\n\n    function GameStarted() {\n        {console.log(\"Context Player = \" + playerCtx)};\n\n        return (\n            <div>\n                {playerCtx.role > 2 ? <AnimatorLoader name={playerCtx.name} room={playerCtx.room} /> :\n                    playerGameStarted ? <div>\n                                            <Header role={roleToString(playerCtx.role)} pseudo={playerCtx.name} bassin={getSubBassin(playerCtx)} />\n                                            <Updating role={roleToString(playerCtx.role)} ut={23} oldUt={34} ub={2} oldUb={12} formations={[1, 1, 0, 1]}/>\n                                        </div>:\n                        <div className=\"App-header\">{PlayersWaitingLobby()}</div>}\n            </div>\n        )\n    }\n\n    function RejoinGame() {\n        return (\n            <div>\n                <p>\n                    <TextField key=\"roomRejoin\" label=\"Code Partie\" value={playerCtx.room} onChange={handleRoomName}/>\n                </p>\n                <p>\n                    <Button variant=\"contained\" color=\"primary\" onClick={getNewPlayerList}>Chercher les joueurs</Button>\n                </p>\n                <InputLabel id=\"nameLabel\">Votre nom dans la partie</InputLabel>\n                <FormControl>\n\n                    <Select\n                        labelId=\"nameLabel\"\n                        id=\"playerSelect\"\n                        value={playerCtx.name + playerCtx.role}\n                        onChange={handleReconnectChange}\n                    >\n                        {playerList.map(item => (\n                            <MenuItem value={item.Name + item.Role}>{item.Name + ` (role : ` + item.Role + `)`}</MenuItem>\n                        ))}\n                    </Select>\n                </FormControl>\n                <p>\n                    <Button variant=\"contained\" color=\"primary\" onClick={handleReconnect}>Rejoindre</Button>\n                </p>\n                {warningText(warningMessage)}\n\n            </div>\n        )\n    }\n\n\n    function MainMenu() {\n        playerCtx.updateRole(\"\")\n        console.log(\"INITIAL PLAYER ROLE = \" + playerCtx);\n        console.log(\"INITIAL MENU CTX = \" + playerCtx);\n        return (\n            <div>\n                <Button variant=\"contained\" color=\"primary\" onClick={() => { MenuCtx.updateLocation(\"create\") }}>Creer la partie</Button>\n                <Button variant=\"contained\" color=\"primary\" onClick={() => { MenuCtx.updateLocation(\"join\") }}>Rejoindre la partie</Button>\n                <Button variant=\"contained\" color=\"primary\" onClick={() => { MenuCtx.updateLocation(\"reconnect\") }}>Reconnexion a la partie en cours</Button>\n                <Button variant=\"contained\" color=\"primary\" onClick={() => { window.location = \"/tutorial\" }}>Tutoriels</Button>\n\n            </div>\n        );\n    }\n\n    return (\n        <>\n\n            {\n                MenuCtx.loc === \"started\" ? GameStarted() :\n                    <div className=\"App-header\">\n                        {MenuCtx.loc === \"menu\" && MainMenu()}\n\n                        {MenuCtx.loc === \"create\" && CreateForm()}\n\n                        {MenuCtx.loc === \"join\" && JoinForm()}\n\n                        {MenuCtx.loc === \"lobbyCreated\" && LobbyCreated()}\n\n                        {MenuCtx.loc === \"reconnect\" && RejoinGame()}\n\n                        {MenuCtx.loc === \"lobbyJoined\" && LobbyJoined()}\n\n\n                    </div>\n            }\n        </>\n    )\n\n}\n\nexport default Menu;\n\n/* réseau zone atelier employeur\neredejeu prestataire des zone atelier\nozcar tereno strasbourg\n*/"]},"metadata":{},"sourceType":"module"}